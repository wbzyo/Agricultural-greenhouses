{% extends 'base_content.html' %}

{% load static %}
<script>

</script>
{% block body-content %}
<section>
    <div class="container-fluid">
        <div class="row ">
            <!--左侧导航结束-->
            <!----------------------------------------------------------------------------------------------------->
            <!--右侧内容开始-->
            <div class="col-xs-10">
                <br/>
                <ol class="breadcrumb">
                    <li><a href="index.html"><span class="glyphicon glyphicon-home"></span>&nbsp;主页</a></li>
                    <li class="active">识别页面</li>
                </ol>
                <h1 class="text-center text-white">绿缘系统</h1>
                <div style="margin-left: 10%">
                    <div class="form-group">
                        <div class="" style="width: 670px;">
                            <form action="identity"  method="post" data-target="#inputfile" enctype="multipart/form-data" >
                            <div id ="preview"  style="width: 650px;">
                                {% if name %}
                                    <img src="{{name}}" alt="" height="350px">
                                {% endif %}
                            </div>
                                {% csrf_token %}
                            <input type="file" name="img" id="inputfile" onchange="handleFiles(this.files)" style="display: inline">

                                <button class="form-actions btn btn-primary btn-lg pull-right" >开始识别</button>
                            </form>


                        <h5>{{ d }}</h5>
                        </div>

                    </div>
                </div>
            </div>
            <!--右侧内容结束-->
        </div>
    </div>
</section>
    <script>
                    $("div .menu-first:eq(1)").addClass("menu-first-active")

    function handleFiles(files) {
  var preview = document.getElementById('preview');
  for (var i = 0; i < files.length; i++) {
    var file = files[i];
    var imageType = /^image\//;

    if ( !imageType.test(file.type) ) {
      continue;
    }

    var img = document.createElement("img");
    img.classList.add("obj");
    img.height=350;
    img.file = file;
    // 假设 "preview" 是将要展示图片的 div
    preview.appendChild(img);

    var reader = new FileReader();
    reader.onload = (function(aImg) {
      return function(e) {
        aImg.src = e.target.result;
      };
    })(img);
    reader.readAsDataURL(file);
  }
  $(".hide").addClass('show')
}
</script>
  {% endblock body-content %}



